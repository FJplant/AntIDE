/*
 * $Header: /AntIDE/source/ant/manager/projectmanager/AddToProjectDialog.java 6     99-05-20 11:41a Remember $
 * Ant ( JDK wrapper Java IDE )
 * Version 1.0
 * Copyright (c) 1998-1999 Antsoft Co. All rights reserved.
 *  This program and source file is protected by Korea and international
 * Copyright laws.
 *
 * $Revision: 6 $
 */
package com.antsoft.ant.manager.projectmanager;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.io.*;

import com.antsoft.ant.util.*;

/**
 * Add to Project를 선택했을때 사용되는 Dialog
 *
 * @author kim sang kyun
 */
public class AddToProjectDialog extends JDialog {

  private JButton selectAllBtn, okBtn, cancelBtn;
  private JCheckBox [] filesCbxs;
  private boolean isOK = false;
  private File dir;

  public AddToProjectDialog(Frame frame, String title, boolean modal, File dir) {
    super(frame, title, modal);
    this.dir = dir;


    String [] files = dir.list( new FilenameFilter() {
			public boolean accept(File dir, String fileName) {
				if ((new File(dir, fileName)).isDirectory() || fileName.toLowerCase().endsWith(".java")
                 || fileName.toLowerCase().endsWith(".html") || fileName.toLowerCase().endsWith(".htm")) return true;
				else return false;
			}
    });

    Box box = Box.createVerticalBox();
    box.setBackground(Color.white);

    if(files != null){
      filesCbxs = new JCheckBox[files.length];
      for(int i = 0; i < files.length; i++){
        filesCbxs[i] = new JCheckBox(files[i]);
        filesCbxs[i].setBackground(Color.white);
        // 디렉토리이면 색을 바꿔주고 싶어!
        if (!files[i].endsWith(".java")) filesCbxs[i].setForeground(Color.blue);
        box.add(filesCbxs[i]);
      }
    }  

    JPanel boxP = new JPanel(new BorderLayout());
    boxP.setBackground(Color.white);
    boxP.add(box);
    boxP.setBorder(BorderList.loweredBorder);
    JScrollPane pane = new JScrollPane(boxP);

    selectAllBtn = new JButton("Select All");
    selectAllBtn.addActionListener(new ActionListener(){
      public void actionPerformed(ActionEvent e){
        if(selectAllBtn.getText().equals("Select All")){
          selectAllBtn.setText("Clear");
          for(int i=0; i<filesCbxs.length; i++) filesCbxs[i].setSelected(true);
        }
        else{
          selectAllBtn.setText("Select All");
          for(int i=0; i<filesCbxs.length; i++) filesCbxs[i].setSelected(false);
        }
      }
    });

    okBtn = new JButton("OK");
    okBtn.addActionListener(new ActionListener(){
      public void actionPerformed(ActionEvent e){
        isOK = true;
        dispose();
      }
    });

    cancelBtn = new JButton("Cancel");
    cancelBtn.addActionListener(new ActionListener(){
      public void actionPerformed(ActionEvent e){
        isOK = false;
        dispose();
      }
    });

    JPanel btnP = new JPanel();
    btnP.add(selectAllBtn);
    btnP.add(okBtn);
    btnP.add(cancelBtn);

    getContentPane().add(pane, BorderLayout.CENTER);
    getContentPane().add(new JPanel(), BorderLayout.WEST);
    getContentPane().add(new JPanel(), BorderLayout.EAST);
    getContentPane().add(btnP, BorderLayout.SOUTH);
    getContentPane().add(new JPanel(), BorderLayout.NORTH);

    setSize(248, 400);

    Dimension m_ScreenSize = Toolkit.getDefaultToolkit().getScreenSize();
    Dimension m_dlgSize = getSize();
    if (m_dlgSize.height > m_ScreenSize.height)  m_dlgSize.height = m_ScreenSize.height;
    if (m_dlgSize.width > m_ScreenSize.width)    m_dlgSize.width = m_ScreenSize.width;
    setLocation((m_ScreenSize.width - m_dlgSize.width) / 2, (m_ScreenSize.height - m_dlgSize.height) / 2);
  }

  public File [] getSelectedFiles(){
    int num = 0;
    for(int i=0; i<filesCbxs.length; i++) if(filesCbxs[i].isSelected()) ++num;

    File [] ret = new File[num];
    int retIndex=0;
    for(int i=0; i<filesCbxs.length; i++) if(filesCbxs[i].isSelected()) {
      ret[retIndex++] = new File(dir, filesCbxs[i].getText());
    }

    return ret;
  }

  public boolean isOK(){
    return isOK;
  }  
}



